## set working directory
setwd("D:/Pacific cod/DataAnalysis/PCod-Korea-repo/otolith_analyses")
# Load packages -----------------------------------------------------------
install.packages("vegan"); library(vegan)
install.packages("dplyr"); library(dplyr)
# Read in data ------------------------------------------------------------
## response matrix
library(readr)
odata <- read_delim("data/PCod_Korea_Microchem_filtered.txt","\t", escape_double = FALSE, trim_ws = TRUE)
dim(odata)
## explanatory data frame
odata_ex <- read_delim("data/PCod_Korea_ExpData_filtered.txt","\t", escape_double = FALSE, trim_ws = TRUE)
dim(odata_ex)
# Manipulate data frames --------------------------------------------------
## need to make sure the order of the explanatory variables are the same as the element concentrations
odata_combo <- full_join(x=odata,y=odata_ex,by="Sample")
odata_el <- odata_combo[,2:17]
View(odata_el)
## add extra column that combines "Site" and "Year" variables
odata_combo <- mutate(odata_combo, SiteYear = paste(Sampling.Site, Year, sep="_"))
View(odata_combo)
elativize by maximum ---------------------------------------------------
## determine effect of relativization
CV <- function(x){100*sd(x) / mean(x)}
CV(colSums(odata_el)) #CV = 264.4698
## relative by column maxima
odata_el.mrel <- decostand(odata_el, method="max")
## make sure relativization worked
head(odata_el.mrel)
par(mfrow=c(2,4))
boxplot(odata_el.mrel$B11.e, main = "B11.e")
boxplot(odata_el.mrel$Ba138.e, main = "Ba138.e")
boxplot(odata_el.mrel$Li7.e, main = "Li7.e")
boxplot(odata_el.mrel$Mg24.e, main = "Mg24.e")
boxplot(odata_el.mrel$Mn55.e, main = "Mn55.e")
boxplot(odata_el.mrel$Pb208.e, main = "Pb208.e")
boxplot(odata_el.mrel$Sr88.e, main = "Sr88.e")
boxplot(odata_el.mrel$Zn66.e, main = "Zn66.e")
write.csv(odata_el.mrel, file = "data/PCod_Korea_Microchem_edge_filtered_relativized.csv", row.names=FALSE)
par(mfrow=c(1,1))
# Make edge / core data frames --------------------------------------------
odata_edge.mrel <- odata_el.mrel[,9:16] # only edge measurements
head(odata_edge.mrel)
odata_core.mrel <- odata_el.mrel[,1:8] # only core measurements
head(odata_core.mrel)
# Euclidean Distance Matrix -----------------------------------------------
edge.mrel_dist <- dist(odata_edge.mrel, method = "euclidean")
core.mrel_dist <- dist(odata_core.mrel, method = "euclidean")
# Load genetic data -------------------------------------------------------
structure <- read.csv("data/PCod_Korea_Structure_assignment.txt", header=TRUE, sep="\t")
# Manipulate data frames --------------------------------------------------
## need to make sure only keep genetic data for samples that were filtered through analyses
gendata <- left_join(x=odata_combo, y=structure)
head(gendata)
View(gendata)
gen_list <- c()
# if western assignment is greater than 0.10; classify as western sample. otherwise, classify as southern sample
for(i in gendata$Cluster1){
if(float(i) > 0.10){
gen_list <- c(gen_list,1)
} else {gen_list <- c(gen_list,2)}
}
gen_list
float
?float
?int
for(i in gendata$Cluster1){
if(i > 0.10){
gen_list <- c(gen_list,1)
} else {gen_list <- c(gen_list,2)}
}
gen_list
gen_data <- mutate(gen_data, Assign=gen_list)
gendata <- mutate(gendata, Assign=gen_list)
length(gendata$Cluster1)
length(gen_list)
gen_list <- c()
# if western assignment is greater than 0.10; classify as western sample. otherwise, classify as southern sample
for(i in gendata$Cluster1){
if(i > 0.10){
gen_list <- c(gen_list,1)
} else {gen_list <- c(gen_list,2)}
}
gen_list
gendata <- mutate(gendata, Assign=gen_list)
length(gendata$Cluster1)
length(gen_list)
print(i)
gen_list <- c()
# if western assignment is greater than 0.10; classify as western sample. otherwise, classify as southern sample
for(i in gendata$Cluster1){
print(i)
if(i > 0.10){
gen_list <- c(gen_list,1)
} else {gen_list <- c(gen_list,2)}
}
View(structure)
# Load genetic data -------------------------------------------------------
structure <- read.csv("data/PCod_Korea_Structure_assignment.txt", header=TRUE, sep="\t")
View(structure)
# Manipulate data frames --------------------------------------------------
## need to make sure only keep genetic data for samples that were filtered through analyses
gendata <- left_join(x=odata_combo, y=structure)
View(gendata)
# Load genetic data -------------------------------------------------------
structure <- read.csv("data/PCod_Korea_Structure_assignment.txt", header=TRUE, sep="\t")
View(structure)
# Manipulate data frames --------------------------------------------------
## need to make sure only keep genetic data for samples that were filtered through analyses
gendata <- left_join(x=odata_combo, y=structure)
View(gendata)
gen_list <- c()
# if western assignment is greater than 0.10; classify as western sample. otherwise, classify as southern sample
for(i in gendata$Cluster1){
print(i)
if(i > 0.10){
gen_list <- c(gen_list,1)
} else {gen_list <- c(gen_list,2)}
}
length(gendata$Cluster1)
length(gen_list)
gendata <- mutate(gendata, Assign=gen_list)
head(gendata$Assign)
View(gendata)
gen_list <- c()
# if western assignment is greater than 0.10; classify as western sample. otherwise, classify as southern sample
for(i in gendata$Cluster1){
if(i > 0.25){
gen_list <- c(gen_list,1)
} else {gen_list <- c(gen_list,2)}
}
length(gendata$Cluster1)
length(gen_list)
gendata <- mutate(gendata, Assign=gen_list)
View(gendata)
which(gendata$Assign==1)
gendata[,gendata$Assign==1)
# Plot Genetic Data over NMDS Edge ---------------------------------------------------
## k = 3, for best visualization
odata_edge.nmds3 <- metaMDS(comm = edge.mrel_dist, autotransform = FALSE,
distance = "euc", engine = "monoMDS", k = 3, weakties = TRUE,
model = "global", maxit = 400, try = 40, trymax = 200,
wascores = TRUE)
gendata[,gendata$Assign==1)]
gendata[,gendata$Assign==1]
gendata[gendata$Assign==1,]
gendata[gendata$Assign==1,gendata$Sampling.Site]
odata_edge.nmds3 <- metaMDS(comm = edge.mrel_dist, autotransform = FALSE,
distance = "euc", engine = "monoMDS", k = 3, weakties = TRUE,
model = "global", maxit = 400, try = 40, trymax = 200,
wascores = TRUE)
## plot
plot(odata_edge.nmds3, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS of Edge with KMeans Clustering of Edge\nK=2")
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="bottomleft", pch = 19, cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"), title = "Sampling Site")
## add ordihull for genetic clusters
ordispider(odata_edge.nmds3, gendata$Assign, col=c("#8dd3c7","gold2"), draw = "polygon", alpha = 80)
plot(odata_edge.nmds3, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS of Edge with KMeans Clustering of Edge\nK=2")
plot(odata_edge.nmds3, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS of Edge with KMeans Clustering of Edge\nK=2")
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="bottomleft", pch = 19, cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"), title = "Sampling Site")
ordispider(odata_edge.nmds3, gendata$Assign, col=c("#8dd3c7","gold2"), draw = "polygon")
plot(odata_edge.nmds3, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS of Edge\nwith Genetic Assignment")
## add ordihull for genetic clusters
ordispider(odata_edge.nmds3, gendata$Assign, col=c("#8dd3c7","gold2"), draw = "polygon")
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="bottomleft", pch = 19, cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"), title = "Sampling Site")
plot(odata_edge.nmds3, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS of Edge\nwith Genetic Assignment")
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Pohang_2015" & gendata$Assign==1,],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Pohang_2015" & gendata$Assign==2,],
pch = 17, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="bottomleft", pch = 19, cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"), title = "Sampling Site")
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Pohang_2015" & gendata$Assign==1,],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Pohang_2015" & gendata$Assign==2,],
pch = 24, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="bottomleft", pch = 19, cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"), title = "Sampling Site")
plot(odata_edge.nmds3, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS of Edge\nwith Genetic Assignment")
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Pohang_2015" & gendata$Assign==1,],
pch = 2, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Pohang_2015" & gendata$Assign==2,],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="bottomleft", pch = 19, cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"), title = "Sampling Site")
plot(odata_edge.nmds3, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS of Edge\nwith Genetic Assignment")
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Pohang_2015" & gendata$Assign==1,],
pch = 17, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Pohang_2015" & gendata$Assign==2,],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="bottomleft", pch = 19, cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"), title = "Sampling Site")
plot(odata_edge.nmds3, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS of Edge\nwith Genetic Assignment")
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Pohang_2015" & gendata$Assign==1,],
pch = 17, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Pohang_2015" & gendata$Assign==2,],
pch = 1, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="bottomleft", pch = 19, cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"), title = "Sampling Site")
plot(odata_edge.nmds3, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS of Edge\nwith Genetic Assignment")
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Pohang_2015" & gendata$Assign==1,],
pch = 17, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Pohang_2015" & gendata$Assign==2,],
pch = 1, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2015"& gendata$Assign==1,],
pch = 17, col = "gold2", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2015"& gendata$Assign==2,],
pch = 1, col = "gold2", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Namhae_2015" & gendata$Assign==2,],
pch = 17, col = "#bebada", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Namhae_2015" & gendata$Assign==2,],
pch = 1, col = "#bebada", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "YSBlock_2016" & gendata$Assign==1,],
pch = 17, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "JinhaeBay_2007" & gendata$Assign==2,],
pch = 1, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "JinhaeBay_2008" & gendata$Assign==1,],
pch = 17, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "JinhaeBay_2008" & gendata$Assign==2,],
pch = 1, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2014" & gendata$Assign==1,],
pch = 17, col = "darkorange", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2014" & gendata$Assign==2,],
pch = 1, col = "darkorange", cex = 1.2)
## add legend
legend(x="bottomleft", pch = 19, cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"), title = "Sampling Site")
plot(odata_edge.nmds3, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS of Edge\nwith Genetic Assignment")
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Pohang_2015" & gendata$Assign==1,],
pch = 17, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Pohang_2015" & gendata$Assign==2,],
pch = 1, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2015"& gendata$Assign==1,],
pch = 17, col = "gold2", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2015"& gendata$Assign==2,],
pch = 1, col = "gold2", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Namhae_2015" & gendata$Assign==1,],
pch = 17, col = "#bebada", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Namhae_2015" & gendata$Assign==2,],
pch = 1, col = "#bebada", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "YSBlock_2016" & gendata$Assign==1,],
pch = 17, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "JinhaeBay_2007" & gendata$Assign==2,],
pch = 1, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "JinhaeBay_2008" & gendata$Assign==1,],
pch = 17, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "JinhaeBay_2008" & gendata$Assign==2,],
pch = 1, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2014" & gendata$Assign==1,],
pch = 17, col = "darkorange", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2014" & gendata$Assign==2,],
pch = 1, col = "darkorange", cex = 1.2)
## add legend
legend(x="bottomleft", pch = 19, cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"), title = "Sampling Site")
plot(odata_edge.nmds3, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS of Edge\nwith Genetic Assignment")
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Pohang_2015" & gendata$Assign==1,],
pch = 17, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Pohang_2015" & gendata$Assign==2,],
pch = 1, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2015"& gendata$Assign==1,],
pch = 17, col = "gold2", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2015"& gendata$Assign==2,],
pch = 1, col = "gold2", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Namhae_2015" & gendata$Assign==1,],
pch = 17, col = "#bebada", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Namhae_2015" & gendata$Assign==2,],
pch = 1, col = "#bebada", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "YSBlock_2016" & gendata$Assign==1,],
pch = 17, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "JinhaeBay_2007" & gendata$Assign==2,],
pch = 1, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "JinhaeBay_2008" & gendata$Assign==1,],
pch = 17, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "JinhaeBay_2008" & gendata$Assign==2,],
pch = 1, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2014" & gendata$Assign==1,],
pch = 17, col = "darkorange", cex = 1.2)
points(odata_edge.nmds3$points[odata_combo$SiteYear == "Geoje_2014" & gendata$Assign==2,],
pch = 1, col = "darkorange", cex = 1.2)
## add legend
legend(x="bottomright", pch = 19, cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"), title = "Sampling Site")
