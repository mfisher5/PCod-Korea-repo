pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="topright", pch = 19, bty="n", cex = 0.8, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"),
title = "Sampling Site")
ordiellipse(odata_edge.nmds7, odata_combo$SiteYear, col=c("#b3de69", "gold2", "#bebada", "#fb8072", "#8dd3c7", "#80b1d3", "darkorange"), kind = "sd", lty = 2, lwd = 2)
ordiellipse(odata_edge.nmds7, odata_combo$SiteYear, col=c("#b3de69", "gold2", "#bebada", "#80b1d3", "#8dd3c7", "#80b1d3", "darkorange"), kind = "sd", lty = 2, lwd = 2)
ordiellipse(odata_edge.nmds7, odata_combo$SiteYear, col=c("#b3de69", "gold2", "#8dd3c7", "#80b1d3", "#bebada", "#80b1d3", "darkorange"), kind = "sd", lty = 2, lwd = 2)
ordiellipse(odata_edge.nmds7, odata_combo$SiteYear, col=c("gold2", "gold2", "#8dd3c7", "#80b1d3", "#bebada", "#b3de69", "darkorange"), kind = "sd", lty = 2, lwd = 2)
ordispider(odata_edge.nmds7, odata_combo$SiteYear, col=c("gold2", "gold2", "#8dd3c7", "#80b1d3", "#bebada", "#b3de69", "darkorange"), kind = "sd", lty = 2, lwd = 2)
plot(odata_edge.nmds7, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS\nMicrochemistry from Otolith Edge")
## set colors for points based on sampling site
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="topright", pch = 19, bty="n", cex = 0.8, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"),
title = "Sampling Site")
ordispider(odata_edge.nmds7, odata_combo$SiteYear, col=c("gold2", "gold2", "#8dd3c7", "#80b1d3", "#bebada", "#b3de69", "darkorange"), kind = "sd", lty = 2)
ordiellipse(odata_edge.nmds7, odata_combo$SiteYear, col=c("gold2", "black", "#8dd3c7", "#80b1d3", "#bebada", "#b3de69", "darkorange"), kind = "sd", lty = 2)
plot(odata_edge.nmds7, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS\nMicrochemistry from Otolith Edge")
## set colors for points based on sampling site
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="topright", pch = 19, bty="n", cex = 0.8, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"), title = "Sampling Site")
ordispider(odata_edge.nmds7, odata_combo$SiteYear, col=c("gold2", "black", "#8dd3c7", "#80b1d3", "#bebada", "#b3de69", "darkorange"), kind = "sd", lty = 2)
plot(odata_edge.nmds7, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS\nMicrochemistry from Otolith Edge")
## set colors for points based on sampling site
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="topright", pch = 19, bty="n", cex = 0.8, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"), title = "Sampling Site")
ordispider(odata_edge.nmds7, odata_combo$SiteYear, col=c("darkorange", "gold2", "#8dd3c7", "#80b1d3", "#bebada", "#b3de69", "#fb8072"), kind = "sd", lty = 2)
plot(odata_edge.nmds7, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS\nMicrochemistry from Otolith Edge")
## set colors for points based on sampling site
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="topright", pch = 19, bty="n", cex = 0.8, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"), title = "Sampling Site")
ordiellipse(odata_edge.nmds7, odata_combo$SiteYear, col=c("darkorange", "gold2", "#8dd3c7", "#80b1d3", "#bebada", "#b3de69", "#fb8072"), kind = "sd", lty = 2)
plot(odata_edge.nmds7, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS\nMicrochemistry from Otolith Edge")
## set colors for points based on sampling site
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="topright", pch = 19, bty="n", cex = 0.8, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"), title = "Sampling Site")
ordiellipse(odata_edge.nmds7, odata_combo$SiteYear, col=c("darkorange", "gold2", "#8dd3c7", "#80b1d3", "#bebada", "#b3de69", "#fb8072"), kind = "sd", lty = 2, lwd = 1.5)
comb_nojb <- subset(odata, Sampling.Site != "JinhaeBay")
comb_nojb <- subset(odata_combo, Sampling.Site != "JinhaeBay")
edge_nojb <- combo_nojb[grep(".e",rownames(combo_nojb)),]
combo_nojb <- subset(odata_combo, Sampling.Site != "JinhaeBay")
edge_nojb <- combo_nojb[grep(".e",rownames(combo_nojb)),]
View(edge_nojb)
edge_nojb <- subset(combo_nojb, ".e" %in% colnames(combo_nojb))
edge_nojb <- subset(combo_nojb, ".e" %in% colnames(combo_nojb)); View(edge_nojb)
edge_elements <- colnames(odata_edge)
edge_elements
edge_nojb <- select(combo_nojb, edge_elements); View(edge_nojb)
dim(edge_nojb)
edge_nojb.mrel <- decostand(edge_nojb, method="max")
edge_nojb_dist <- dist(edge_nojb.mrel, method = "euclidean")
unique(combo_nojb$SiteYear)
ks <- c(1,2,3,4,5)
stresses <- c()
for(k in ks){
odata_edge.nmds <- metaMDS(comm = edge_nojb_dist, autotransform = FALSE,
distance = "euc", engine = "monoMDS", k = k, weakties = TRUE,
model = "global", maxit = 400, try = 40, trymax = 200,
wascores = TRUE)
stresses[k] <- odata_edge.nmds$stress
}
plot(ks,stresses, xlab="K", ylab="stress", main="Value of K v. Stress of NMDS")
odata_edge_nojb.nmds5 <- metaMDS(comm = edge_nojb_dist, autotransform = FALSE,
distance = "euc", engine = "monoMDS", k = 5, weakties = TRUE,
model = "global", maxit = 400, try = 40, trymax = 200,
wascores = TRUE)
odata_edge_nojb.nmds5
stressplot(object=odata_edge_nojb.nmds5, lwd=2)
plot(odata_edge_nojb.nmds5, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS\nMicrochemistry from Otolith Edge")
## set colors for points based on sampling site
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="topright", pch = 19, bty="n", cex = 0.8, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "Pohang '15"), title = "Sampling Site")
plot(odata_edge_nojb.nmds5, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS without Jinhae Bay\nMicrochemistry from Otolith Edge")
## set colors for points based on sampling site
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="topright", pch = 19, bty="n", cex = 0.8, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "Pohang '15"), title = "Sampling Site")
ordiellipse(odata_edge_nojb.nmds5, odata_combo$SiteYear, col=c("darkorange", "gold2", "#bebada", "#b3de69", "#fb8072"), kind = "sd", lty = 2, lwd = 1.5)
ordiellipse(odata_edge_nojb.nmds5, combo_nojb$SiteYear, col=c("darkorange", "gold2", "#bebada", "#b3de69", "#fb8072"), kind = "sd", lty = 2, lwd = 1.5)
plot(odata_edge_nojb.nmds5, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS without Jinhae Bay\nMicrochemistry from Otolith Edge")
## set colors for points based on sampling site
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="topleft", pch = 19, bty="n", cex = 0.8, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "Pohang '15"), title = "Sampling Site")
# Add ellipses etc. -------------------------------------------------------
ordiellipse(odata_edge_nojb.nmds5, combo_nojb$SiteYear, col=c("darkorange", "gold2", "#bebada", "#b3de69", "#fb8072"), kind = "sd", lty = 2, lwd = 1.5)
elements.fit <- envfit(odata_edge_nojb.nmds5 ~ B11.e + Ba138.e + Li7.e + Mg24.e + Mn55.e + Pb208.e + Sr88.e + Zn66.e, data = combo_nojb)
plot(elements.fit, col = "black")
head(odata_combo)
odata_core <- odata_combo[2,8]
head(odata_combo)
head(odata_core)
odata_core <- odata_combo[,2:8]
head(odata_core)
odata_core <- odata_combo[,2:9]
head(odata_core)
odata_edge <- odata_combo[,10:17]
head(odata_edge)
odata_edge.mrel <- decostand(odata_edge, method="max")
odata_core.mrel <- decostand(odata_core, method="max")
edge.mrel_dist <- dist(odata_edge.mrel, method = "euclidean")
core.mrel_dist <- dist(odata_core.mrel, method = "euclidean")
edge.hclust <- hclust(d = edge.mrel_dist, method = "ward.D2")
core.hclust <- hclust(d = core.mrel_dist, method = "ward.D2")
str(edge.hclust)
edge.hclust$height
edge.hclust$merge
plot(edge.hclust)
plot(core.hclust)
plot(edge.hclust, hang = -1, main = "Edge Microchemistry\nCluster Dendrogram",
ylab = "Dissimilarity", xlab = "Coded by Site",
sub = "Euclidean dissimilarity; ward.D2 linkage",
labels = odata_combo$SiteYear)
plot(core.hclust, hang = -1, main = "Core Microchemistry\nCluster Dendrogram",
ylab = "Dissimilarity", xlab = "Coded by Site",
sub = "Euclidean dissimilarity; ward.D2 linkage",
labels = odata_combo$SiteYear)
edge_heights <- cbind(edge.hclust$height, edge.hclust$merge)
colnames(edge_heights) <- c("Height", "JoinThis", "WithThis")
plot(x=12:1, y=edge_heights[(nrow(edge_heights) - 11):nrow(edge_heights),1],
xlab="Number of groups", ylab="Height", type="b", main="Edge")
plot(x=16:1, y=edge_heights[(nrow(edge_heights) - 11):nrow(edge_heights),1],
xlab="Number of groups", ylab="Height", type="b", main="Edge")
plot(x=16:1, y=edge_heights[(nrow(edge_heights) - 15):nrow(edge_heights),1],
xlab="Number of groups", ylab="Height", type="b", main="Edge")
core_heights <- cbind(core.hclust$height, core.hclust$merge)
colnames(core_heights) <- c("Height", "JoinThis", "WithThis")
plot(x=16:1, y=core_heights[(nrow(core_heights) - 15):nrow(core_heights),1],
xlab="Number of groups", ylab="Height", type="b", main="Core")
OtoCluster <- function(edist = edge.mrel_dist, cdist = core.mrel_dist, method = "ward.D2"){
## conduct cluster analysis
edge.hclust <- hclust(d = edist, method = method)
core.hclust <- hclust(d = cdist, method = method)
## plot dendrogram
plot(edge.hclust, hang = -1, main = "Edge Microchemistry\nCluster Dendrogram",
ylab = "Dissimilarity", xlab = "Coded by Site",
sub = paste("Euclidean dissimilarity;", method, sep=" "),
labels = odata_combo$SiteYear)
plot(core.hclust, hang = -1, main = "Core Microchemistry\nCluster Dendrogram",
ylab = "Dissimilarity", xlab = "Coded by Site",
sub = paste("Euclidean dissimilarity;", method, sep=" "),
labels = odata_combo$SiteYear)
## how many groups?
edge_heights <- cbind(edge.hclust$height, edge.hclust$merge)
colnames(edge_heights) <- c("Height", "JoinThis", "WithThis")
plot(x=16:1, y=edge_heights[(nrow(edge_heights) - 15):nrow(edge_heights),1],
xlab="Number of groups", ylab="Height", type="b", main="Edge")
core_heights <- cbind(core.hclust$height, core.hclust$merge)
colnames(core_heights) <- c("Height", "JoinThis", "WithThis")
plot(x=16:1, y=core_heights[(nrow(core_heights) - 15):nrow(core_heights),1],
xlab="Number of groups", ylab="Height", type="b", main="Core")
}
OtoCluster(edist = edge.mrel_dist, cdist = core.mrel_dist, method = "ward.D2")
OtoCluster(edist = edge.mrel_dist, cdist = core.mrel_dist, method = "ward.D2")
cutree(edge.hclust, k=10)
head(core_heights)
core_heights
plot(edge.hclust, hang = -1, main = "Edge Microchemistry\nCluster Dendrogram",
ylab = "Dissimilarity", xlab = "Coded by Site",
sub = paste("Euclidean dissimilarity;", method, sep=" "),
labels = odata_combo$SiteYear)
abline(h = 1)
abline(h = 1.2)
abline(h = 1.3)
plot(edge.hclust, hang = -1, main = "Edge Microchemistry\nCluster Dendrogram",
ylab = "Dissimilarity", xlab = "Coded by Site",
sub = paste("Euclidean dissimilarity;", method, sep=" "),
labels = odata_combo$SiteYear)
abline(h = 1.25)
plot(edge.hclust, hang = -1, main = "Edge Microchemistry\nCluster Dendrogram",
ylab = "Dissimilarity", xlab = "Coded by Site",
sub = "Euclidean dissimilarity;Ward.d2",
labels = odata_combo$SiteYear)
abline(h = 1.25)
g10 <- rect.hclust(edge.hclust, k=10)
edge_conmat_ward <- table(g10, cutree(edge.hclust, k = 10))
g10 <- rect.hclust(core.hclust, k=10)
core_conmat_ward <- table(g10, cutree(core.hclust, k = 10))
g10 <- rect.hclust(edge.hclust, k=10)
edge_conmat_ward <- table(g10, cutree(edge.hclust, k = 10))
g10 <- cutree(edge.hclust, k=10)
edge_conmat_ward <- table(g10, cutree(edge.hclust, k = 10))
g10 <- cutree(core.hclust, k=10)
core_conmat_ward <- table(g10, cutree(core.hclust, k = 10))
OtoCluster(edist = edge.mrel_dist, cdist = core.mrel_dist, method = "ward.D2")
rect.hclust(edge.hclust, k=5)
rect.hclust(core.hclust, k=5)
rect.hclust(core.hclust, k=4)
rect.hclust(core.hclust, k=7)
g5 <- cutree(edge.hclust, k=5)
edge_conmat_ward5 <- table(g5, cutree(edge.hclust, k = 5))
g5 <- cutree(core.hclust, k=5)
core_conmat_ward5 <- table(g5, cutree(core.hclust, k = 5))
require(NbClust)
install.packages("NbClust")
require(NbClust)
NbClust(data = odata_edge, diss = edge.mrel_dist, distance=NULL, method="ward.D2", index="gap")
View(odata_edge)
core_conmat_ward5
edge_conmat_ward5
OtoCluster(edist = edge.mrel_dist, cdist = core.mrel_dist, method = "ward.D2")
OtoCluster(edist = edge.mrel_dist, cdist = core.mrel_dist, method = "average")
rect.clust(edge.hclust, k=7)
rect.hclust(core.hclust, k=7)
OtoCluster(edist = edge.mrel_dist, cdist = core.mrel_dist, method = "average")
rect.hclust(edge.hclust, k=7)
str(edge.hclust)
OtoCluster(edist = edge.mrel_dist, cdist = core.mrel_dist, method = "ward.D2")
rect.hclust(edge.hclust, k=7)
rect.hclust(core.hclust, k=7)
OtoCluster(edist = edge.mrel_dist, cdist = core.mrel_dist, method = "average")
edge.hclust <- hclust(d = edist, method = "average")
core.hclust <- hclust(d = cdist, method = "average")
edge.hclust <- hclust(d = edge.mrel_dist, method = "average")
core.hclust <- hclust(d = core.mrel_dist, method = "average")
rect.hclust(edge.hclust, k=7)
rect.hclust(core.hclust, k=7)
OtoCluster(edist = edge.mrel_dist, cdist = core.mrel_dist, method = "complete")
edge.hclust <- hclust(d = edge.mrel_dist, method = "complete")
core.hclust <- hclust(d = core.mrel_dist, method = "complete")
rect.hclust(edge.hclust, k=7)
rect.hclust(core.hclust, k=7)
plot(odata_edge_nojb.nmds5, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS without Jinhae Bay\nMicrochemistry from Otolith Edge")
## set colors for points based on sampling site
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="topleft", pch = 19, bty="n", cex = 0.8, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "Pohang '15"), title = "Sampling Site")
elements.fit <- envfit(odata_edge_nojb.nmds5 ~ B11.e + Ba138.e + Li7.e + Mg24.e + Mn55.e + Pb208.e + Sr88.e + Zn66.e, data = combo_nojb)
## plot element vectors
plot(elements.fit, col = "black")
ordiellipse(odata_edge_nojb.nmds5, combo_nojb$SiteYear, col=c("darkorange", "gold2", "#bebada", "#b3de69", "#fb8072"), kind = "sd", lty = 2, lwd = 1.5)
plot(odata_edge_nojb.nmds5, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS without Jinhae Bay\nMicrochemistry from Otolith Edge")
## set colors for points based on sampling site
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="topleft", pch = 19, bty="n", cex = 0.8, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "Pohang '15"), title = "Sampling Site")
# Add ellipses etc. -------------------------------------------------------
ordiellipse(odata_edge_nojb.nmds5, combo_nojb$SiteYear, col=c("darkorange", "gold2", "#bebada", "#b3de69", "#fb8072"), kind = "sd", lty = 2, lwd = 1.5)
# Add Element Vectors -----------------------------------------------------
## fit elements to nmds
elements.fit <- envfit(odata_edge_nojb.nmds5 ~ B11.e + Ba138.e + Li7.e + Mg24.e + Mn55.e + Pb208.e + Sr88.e + Zn66.e, data = combo)
## plot element vectors
plot(elements.fit, col = "black")
plot(odata_edge.nmds7, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS\nMicrochemistry from Otolith Edge")
## set colors for points based on sampling site
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="topright", pch = 19, bty="n", cex = 0.8, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"), title = "Sampling Site")
# Add ellipses etc. -------------------------------------------------------
ordiellipse(odata_edge.nmds7, odata_combo$SiteYear, col=c("darkorange", "gold2", "#8dd3c7", "#80b1d3", "#bebada", "#b3de69", "#fb8072"), kind = "sd", lty = 2, lwd = 1.5)
# Add Element Vectors -----------------------------------------------------
## fit elements to nmds
elements.fit <- envfit(odata_edge.nmds7 ~ B11.e + Ba138.e + Li7.e + Mg24.e + Mn55.e + Pb208.e + Sr88.e + Zn66.e, data = odata_combo)
## plot element vectors
plot(elements.fit, col = "black")
plot(odata_edge.nmds7, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS\nMicrochemistry from Otolith Edge")
## set colors for points based on sampling site
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="topright", pch = 19, bty="n", cex = 0.8, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"), title = "Sampling Site")
# Add ellipses etc. -------------------------------------------------------
ordiellipse(odata_edge.nmds7, odata_combo$SiteYear, col=c("darkorange", "gold2", "#8dd3c7", "#80b1d3", "#bebada", "#b3de69", "#fb8072"), kind = "sd", lty = 2, lwd = 1.5)
# Add Element Vectors -----------------------------------------------------
## fit elements to nmds
elements.fit <- envfit(odata_edge.nmds7 ~ B11.e + Ba138.e + Li7.e + Mg24.e + Mn55.e + Pb208.e + Sr88.e + Zn66.e, data = odata_combo)
## plot element vectors
plot(elements.fit, col = "black")
plot(odata_edge.nmds7, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS\nMicrochemistry from Otolith Edge")
## set colors for points based on sampling site
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="topright", pch = 19, bty="n", cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"), title = "Sampling Site")
ordiellipse(odata_edge.nmds7, odata_combo$SiteYear, col=c("darkorange", "gold2", "#8dd3c7", "#80b1d3", "#bebada", "#b3de69", "#fb8072"), kind = "sd", lty = 2, lwd = 1.5)
# Add Element Vectors -----------------------------------------------------
## fit elements to nmds
elements.fit <- envfit(odata_edge.nmds7 ~ B11.e + Ba138.e + Li7.e + Mg24.e + Mn55.e + Pb208.e + Sr88.e + Zn66.e, data = odata_combo)
## plot element vectors
plot(elements.fit, col = "black")
plot(odata_edge_nojb.nmds5, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS without Jinhae Bay\nMicrochemistry from Otolith Edge")
## set colors for points based on sampling site
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="topleft", pch = 19, bty="n", cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "Pohang '15"), title = "Sampling Site")
# Add ellipses etc. -------------------------------------------------------
ordiellipse(odata_edge_nojb.nmds5, combo_nojb$SiteYear, col=c("darkorange", "gold2", "#bebada", "#b3de69", "#fb8072"), kind = "sd", lty = 2, lwd = 1.5)
# Add Element Vectors -----------------------------------------------------
## fit elements to nmds
elements.fit <- envfit(odata_edge_nojb.nmds5 ~ B11.e + Ba138.e + Li7.e + Mg24.e + Mn55.e + Pb208.e + Sr88.e + Zn66.e, data = combo)
## plot element vectors
plot(elements.fit, col = "black")
plot(odata_edge_nojb.nmds5, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS without Jinhae Bay\nMicrochemistry from Otolith Edge")
## set colors for points based on sampling site
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="topleft", pch = 19, bty="n", cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "Pohang '15"), title = "Sampling Site")
# Add ellipses etc. -------------------------------------------------------
ordiellipse(odata_edge_nojb.nmds5, combo_nojb$SiteYear, col=c("darkorange", "gold2", "#bebada", "#b3de69", "#fb8072"), kind = "sd", lty = 2, lwd = 1.5)
# Add Element Vectors -----------------------------------------------------
## fit elements to nmds
elements.fit <- envfit(odata_edge_nojb.nmds5 ~ B11.e + Ba138.e + Li7.e + Mg24.e + Mn55.e + Pb208.e + Sr88.e + Zn66.e, data = combo)
## plot element vectors
plot(elements.fit, col = "black")
