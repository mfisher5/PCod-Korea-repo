# Load data ---------------------------------------------------------------
odata <- read.csv("data/PCod_Korea_Microchem_filtered.txt", header=TRUE, sep="\t")
odata_ex <- read.csv("data/PCod_Korea_ExpData_filtered.txt", header=TRUE, sep="\t")
dim(odata)
dim(odata_ex)
# Load packages -
odata_combo <- full_join(x=odata,y=odata_ex,by="Sample")
odata_combo <- mutate(odata_combo, SiteYear=paste(Sampling.Site,Year,sep="_")) # add column with site & year
head(odata_combo)
## make data frame of only edge concentrations
odata_edge <- odata[,10:17]
head(odata_edge)
odata_edge.mrel <- decostand(odata_edge, method="max")
head(odata_edge.mrel)
write.csv(odata_edge.mrel, file = "data/PCod_Korea_Microchem_edge_filtered_relativized.csv", row.names=FALSE)
odata_core <- odata[1:10]
head(odata_core)
odata_core <- odata[2:10]
head(odata_core)
odata_core.mrel <- decostand(odata_core,method="max")
head(odata_core.mrel)
edge.mrel_dist <- dist(odata_edge.mrel, method = "euclidean")
core.mrel_dist <- dist(odata_core.mrel, method = "euclidean")
odata_mantel <- mantel(xdis = edge.mrel_dist, ydis = core.mrel_dist,
method = "pearman", permutations = 99999)
odata_mantel <- mantel(xdis = edge.mrel_dist, ydis = core.mrel_dist,
method = "pearson", permutations = 99999)
str(odata_mantel)
odata_mantel
plot(odata_mantel$perm)
plot(odata_mantel$perm)
str(odata_mantel)
hist(odata_mantel$perm)
odata_el <- odata[,2:17]
install.packages("MVN", dependencies=TRUE)
mardiaTest(odata_el, qqplot = TRUE)
library(MVN)
mardiaTest(odata_el, qqplot = TRUE)
install.packages("zoo", type="source", repos="http://cran.stat.ucla.edu/")
install.packages("zoo", type = "source", repos = "http://cran.stat.ucla.edu/")
library(zoo)
mardiaTest(odata_el, qqplot = TRUE)
CV <- function(x){100*sd(x) / mean(x)}
CV(colSums(odata_edge)) #CV = 274.4344
