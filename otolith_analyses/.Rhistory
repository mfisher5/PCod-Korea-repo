plot(x=16:1, y=core_heights[(nrow(core_heights) - 15):nrow(core_heights),1],
xlab="Number of groups", ylab="Height", type="b", main="Core")
}
OtoCluster(edist = edge.mrel_dist, cdist = core.mrel_dist, method = "ward.D2")
edge.hclust <- hclust(d = edge.mrel_dist, method = "ward.D2")
core.hclust <- hclust(d = core.mrel_dist, method = "ward.D2")
install.packages("pvclust")
library(pvclust)
pvclust(odata_edge.mrel, method.hclust="ward.D2",
method.dist="euclidean", use.cor="pairwise.complete.obs",
nboot = 1000, parallel=TRUE, iseed=201)
edge.wd2 <- pvclust(odata_edge.mrel, method.hclust="ward.D2",
method.dist="euclidean", use.cor="pairwise.complete.obs",
nboot = 1000, parallel=TRUE, iseed=201)
plot(edge.wd2)
odata_edge.mrel
edge_mrel_transposed <- t(odata_edge.mrel)
View(edge_mrel_transposed)
colnames(edge_mrel_transposed) <- odata_combo$Sample
View(edge_mrel_transposed)
edge.wd2 <- pvclust(edge_mrel_transposed, method.hclust="ward.D2",
method.dist="euclidean", use.cor="pairwise.complete.obs",
nboot = 1000, parallel=TRUE, iseed=201)
plot(edge.wd2)
edge.wd2
dim(edge_mrel_transposed)
edge.wd2 <- pvclust(edge_mrel_transposed, method.hclust="ward.D2",
method.dist="euclidean", nboot = 100)
warnings()
colnames(edge_mrel_transposed) <- odata_combo$SiteYear
edge.wd2 <- pvclust(edge_mrel_transposed, method.hclust="ward.D2",
method.dist="euclidean", nboot = 100)
edge.wd2 <- pvclust(edge_mrel_transposed, method.hclust="ward.D2", r=seq(0.5,1,by=0.1)
method.dist="euclidean", nboot = 100)
edge.wd2 <- pvclust(edge_mrel_transposed, method.hclust="ward.D2", r=seq(0.5,1,by=0.1),
method.dist="euclidean", nboot = 100)
plot(edge.wd2)
summary(edge.wd2)
print.pvclust(edge.wd2)
library(pvclust)
print.pvclust(edge.wd2)
plot.pvclust(edge.wd2)
print(edge.wd2)
pvpick(edge.wd2, alpha = 0.95, pv="au")
colnames(edge_mrel_transposed) <- odata_combo$Sample
edge.wd2 <- pvclust(edge_mrel_transposed, method.hclust="ward.D2", r=seq(0.5,1,by=0.1),
method.dist="euclidean", nboot = 100)
plot(edge.wd2)
pvpick(edge.wd2, alpha = 0.95, pv="au")
pvrect(edge.wd2, alpha = 0.95, pv="au")
core_mrel_transposed <- t(core_edge.mrel)
core_mrel_transposed <- t(odata_core.mrel)
dim(core_mrel_transposed)
colnames(core_mrel_transposed) <- odata_combo$Sample
edge.wd2 <- pvclust(core_mrel_transposed, method.hclust="ward.D2", r=seq(0.5,1,by=0.1),
method.dist="euclidean", nboot = 100)
plot(edge.wd2)
pvrect(edge.wd2, alpha = 0.95, pv="au")
core.wd2 <- pvclust(core_mrel_transposed, method.hclust="ward.D2", r=seq(0.5,12,by=0.05), method.dist="euclidean", nboot = 100)
core.wd2 <- pvclust(core_mrel_transposed, method.hclust="ward.D2", r=seq(0.5,1,by=0.05), method.dist="euclidean", nboot = 100)
core.wd2 <- pvclust(core_mrel_transposed, method.hclust="ward.D2", r=seq(0.5,1,by=0.1), method.dist="euclidean", nboot = 100)
plot(core.wd2)
pvrect(core.wd2, alpha = 0.95, pv="au")
plot(edge.wd2)
OtoCluster(edist = edge.mrel_dist, cdist = core.mrel_dist, method = "ward.D2")
plot(edge.hclust <- hclust(d = edge.mrel_dist, method = "ward.D2")) # create object outside function
rect.hclust(edge.hclust, k=7) # only run this when edge dendrogram is displayed in plot area
plot(core.hclust <- hclust(d = core.mrel_dist, method = "ward.D2")) # create object outside function
rect.hclust(core.hclust, k=7) # only run this when core dendrogram is displayed in plot area
NbClust(data = odata_edge.mrel, diss = edge.mrel_dist, distance = NULL, method="ward.D2", index="gap")
install.packages("NbClust")
require(NbClust)
NbClust(data = odata_edge.mrel, diss = edge.mrel_dist, distance = NULL, method="ward.D2", index="gap")
core_mrel_transposed <- t(odata_core.mrel)
dim(core_mrel_transposed)
NbClust(data = odata_edge.mrel, diss = edge.mrel_dist, distance=NULL, method="ward.D2", index="gap")
NbClust(data=odata_core.mrel, diss=core.mrel_dist, distance=NULL, method="ward.D2", index="gap")
OtoCluster(edist = edge.mrel_dist, cdist = core.mrel_dist, method = "average")
edge.hclust <- hclust(d = edge.mrel_dist, method = "average")
core.hclust <- hclust(d = core.mrel_dist, method = "average")
rect.hclust(edge.hclust, k=7)
rect.hclust(core.hclust, k=7)
rect.hclust(core.hclust, k=7)
NbClust(data = odata_edge.mrel, diss = edge.mrel_dist,
distance=NULL, method="average", index="gap")
NbClust(data=odata_core.mrel, diss=core.mrel_dist,
distance=NULL, method="average", index="gap")
NbClust(data = odata_edge.mrel, diss = edge.mrel_dist,
distance=NULL, method="complete", index="gap")
NbClust(data=odata_core.mrel, diss=core.mrel_dist,
distance=NULL, method="complete", index="gap")
edge.hclust <- hclust(d = edge.mrel_dist, method = "complete")
core.hclust <- hclust(d = core.mrel_dist, method = "complete")
plot(core.hclust)
plot(core.hclust, hang = -1, main = "Core Microchemistry\nCluster Dendrogram",
ylab = "Dissimilarity", xlab = "Coded by Site",
sub = paste("Euclidean dissimilarity;", method, sep=" "),
labels = odata_combo$SiteYear)
plot(core.hclust, hang = -1, main = "Core Microchemistry\nCluster Dendrogram",
ylab = "Dissimilarity", xlab = "Coded by Site",
sub = paste("Euclidean dissimilarity;", method="ward.D2", sep=" "),
labels = odata_combo$SiteYear)
rect.hclust(core.hclust, k=2)
rect.hclust(core.hclust, k=4)
plot(core.hclust, hang = -1, main = "Core Microchemistry\nCluster Dendrogram",
ylab = "Dissimilarity", xlab = "Coded by Site",
sub = paste("Euclidean dissimilarity;", method="ward.D2", sep=" "),
labels = odata_combo$SiteYear)
rect.hclust(core.hclust, k=4)
core.hclust.g2 <- cutree(core.hclust, k=2)
core.hclust.g2 <- cutree(core.hclust, k=3)
core.hclust <- hclust(d = core.mrel_dist, method = "ward.D2")
core.hclust.g2 <- cutree(core.hclust, k=2)
core.hclust.g3 <- cutree(core.hclust, k=3)
core.hclust.g4 <- cutree(core.hclust, k=4)
odata_edge.nmds7 <- metaMDS(comm = edge.mrel_dist, autotransform = FALSE,
distance = "euc", engine = "monoMDS", k = 7, weakties = TRUE,
model = "global", maxit = 400, try = 40, trymax = 200,
wascores = TRUE)
install.packages("vegan")
library(vegan)
odata_edge.nmds7 <- metaMDS(comm = edge.mrel_dist, autotransform = FALSE,
distance = "euc", engine = "monoMDS", k = 7, weakties = TRUE,
model = "global", maxit = 400, try = 40, trymax = 200,
wascores = TRUE)
ordicluster(odata_edge.nmds7, cluster=core.hclust, prune = 2)
plot(odata_edge.nmds7, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS\nMicrochemistry from Otolith Edge")
ordicluster(odata_edge.nmds7, cluster=core.hclust, prune = 2)
plot(odata_edge.nmds7, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS\nMicrochemistry from Otolith Edge")
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
legend(x="topright", pch = 19, bty="n", cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"), title = "Sampling Site")
ordihull(odata_edge.nmds7, groups = core.hclust.g2, col = "blue", lwd = 2)
ordihull(odata_edge.nmds7, groups = core.hclust.g3, col = "red", lwd = 2)
ordihull(odata_edge.nmds7, groups = core.hclust.g4, col = "black", lwd = 2)
plot(odata_edge.nmds7, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS\nMicrochemistry from Otolith Edge")
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
legend(x="topright", pch = 19, bty="n", cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"), title = "Sampling Site")
ordihull(odata_edge.nmds7, groups = core.hclust.g2, col = "blue", lwd = 2, lty= 2)
ordihull(odata_edge.nmds7, groups = core.hclust.g2, col = "darkgrey", lwd = 2, lty= 2)
ordihull(odata_edge.nmds7, groups = core.hclust.g2, col = "darkgrey2", lwd = 2, lty= 2)
ordihull(odata_edge.nmds7, groups = core.hclust.g2, col = "gray28", lwd = 2, lty= 2)
plot(odata_edge.nmds7, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS\nMicrochemistry from Otolith Edge")
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
legend(x="topright", pch = 19, bty="n", cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"), title = "Sampling Site")
ordihull(odata_edge.nmds7, groups = core.hclust.g3, col = "gray28", lwd = 2, lty= 2)
plot(odata_edge.nmds7, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS\nMicrochemistry from Otolith Edge")
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
legend(x="topright", pch = 19, bty="n", cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"), title = "Sampling Site")
ordihull(odata_edge.nmds7, groups = core.hclust.g4, col = "gray28", lwd = 2, lty= 2)
core.mrel_dist <- dist(odata_core.mrel, method = "euclidean")
head(odata_core.mrel)
unique(odata_combo$SiteYear)
ks <- c(1,2,3,4,5,6,7)
## run nmds for k = 1 through 7 and save stress values
stresses <- c()
for(k in ks){
odata_core.nmds <- metaMDS(comm = core.mrel_dist, autotransform = FALSE,
distance = "euc", engine = "monoMDS", k = k, weakties = TRUE,
model = "global", maxit = 400, try = 40, trymax = 200,
wascores = TRUE)
stresses[k] <- odata_core.nmds$stress
}
## plot k v. stress
plot(ks,stresses, xlab="K", ylab="stress", main="Value of K v. Stress of NMDS, Core")
odata_core.nmds7 <- metaMDS(comm = core.mrel_dist, autotransform = FALSE,
distance = "euc", engine = "monoMDS", k = 7, weakties = TRUE,
model = "global", maxit = 400, try = 40, trymax = 200,
wascores = TRUE)
odata_core.nmds7
stressplot(object=odata_core.nmds7, lwd=2)
plot(odata_core.nmds7, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS\nMicrochemistry from Otolith Core")
## set colors for points based on sampling site
points(odata_core.nmds7$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="topright", pch = 19, bty="n", cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"), title = "Sampling Site")
plot(odata_core.nmds7, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS\nMicrochemistry from Otolith Core")
## set colors for points based on sampling site
points(odata_core.nmds7$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="bottomleft", pch = 19, bty="n", cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "JinhaeBay '07e", "JinhaeBay '07l", "Pohang '15"), title = "Sampling Site")
ordiellipse(odata_core.nmds7, odata_combo$SiteYear, col=c("darkorange", "gold2", "#8dd3c7", "#80b1d3", "#bebada", "#b3de69", "#fb8072"), kind = "sd", lty = 2, lwd = 1.5)
elements.fit <- envfit(odata_core.nmds7 ~ B11.e + Ba138.e + Li7.e + Mg24.e + Mn55.e + Pb208.e + Sr88.e + Zn66.e, data = odata_combo)
## plot element vectors
plot(elements.fit, col = "black")
core_nojb.mrel <- decostand(core_nojb, method="max")
core_elements <- colnames(odata_core)
core_nojb <- select(combo_nojb, core_elements); View(core_nojb)
install.packages("dplyr")
library(dplyr)
core_elements <- colnames(odata_core)
core_nojb <- select(combo_nojb, core_elements); View(core_nojb)
core_nojb.mrel <- decostand(core_nojb, method="max")
core_nojb_dist <- dist(core_nojb.mrel, method = "euclidean")
stresses <- c()
for(k in ks){
odata_core.nmds <- metaMDS(comm = core_nojb_dist, autotransform = FALSE,
distance = "euc", engine = "monoMDS", k = k, weakties = TRUE,
model = "global", maxit = 400, try = 40, trymax = 200,
wascores = TRUE)
stresses[k] <- odata_core.nmds$stress
}
plot(ks,stresses, xlab="K", ylab="stress", main="Value of K v. Stress of NMDS, Core (no JB)")
odata_core_nojb.nmds5 <- metaMDS(comm = core_nojb_dist, autotransform = FALSE,
distance = "euc", engine = "monoMDS", k = 5, weakties = TRUE,
model = "global", maxit = 400, try = 40, trymax = 200,
wascores = TRUE)
odata_core_nojb.nmds5
stressplot(object=odata_core_nojb.nmds5, lwd=2)
plot(odata_core_nojb.nmds5, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS without Jinhae Bay\nMicrochemistry from Otolith Edge")
## set colors for points based on sampling site
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
dim(edge_nojb)
dim(core_nojb)
dim(odata_core)
plot(odata_core_nojb.nmds5, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS without Jinhae Bay\nMicrochemistry from Otolith Edge")
## set colors for points based on sampling site
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_edge_nojb.nmds5$points[combo_nojb$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="topleft", pch = 19, bty="n", cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "Pohang '15"), title = "Sampling Site")
head(odata_combo)
head(odata_el)
head(odata_core)
dim(odata_core)
plot(odata_core_nojb.nmds5, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS without Jinhae Bay\nMicrochemistry from Otolith Edge")
## set colors for points based on sampling site
points(odata_core_nojb.nmds5$points[combo_nojb$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_core_nojb.nmds5$points[combo_nojb$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_core_nojb.nmds5$points[combo_nojb$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_core_nojb.nmds5$points[combo_nojb$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_core_nojb.nmds5$points[combo_nojb$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## add legend
legend(x="topleft", pch = 19, bty="n", cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#b3de69"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "Pohang '15"), title = "Sampling Site")
ordiellipse(odata_core_nojb.nmds5, combo_nojb$SiteYear, col=c("darkorange", "gold2", "#bebada", "#b3de69", "#fb8072"), kind = "sd", lty = 2, lwd = 1.5)
elements.fit.k5 <- envfit(odata_core_nojb.nmds5 ~ B11.e + Ba138.e + Li7.e + Mg24.e + Mn55.e + Pb208.e + Sr88.e + Zn66.e, data = combo_nojb)
plot(elements.fit.k5, col = "black")
plot(odata_core.nmds7, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS\nMicrochemistry from Otolith Core")
## CORE: set colors fo
points(odata_core.nmds7$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## EDGE: set colors for points based on sampling site
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 2, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 2, col = "gold2", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 2, col = "#bebada", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 2, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 2, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 2, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 2, col = "darkorange", cex = 1.2)
ordiellipse(odata_core_nojb.nmds5, combo_nojb$SiteYear, col=c("darkorange", "gold2", "#bebada", "#b3de69", "#fb8072"), kind = "sd", lty = 2, lwd = 1.5)
legend(x="topleft", pch = c(19,19,19,19,19,19,19,19,2), bty="n", cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#b3de69","black","black"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "Pohang '15", "JinBay '07e", "JinBay '07l"), title = "Sampling Site")
plot(odata_core.nmds7, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS\nMicrochemistry from Otolith Core and Edge")
## CORE: set colors for points based on sampling site
points(odata_core.nmds7$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## EDGE: set colors for points based on sampling site
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 2, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 2, col = "gold2", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 2, col = "#bebada", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 2, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 2, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 2, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 2, col = "darkorange", cex = 1.2)
## add legend
legend(x="topleft", pch = c(19,19,19,19,19,19,19,19,2), bty="n", cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69","black","black"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "Pohang '15", "JinhaeBay '07e", "JinhaeBay '07l"), title = "Sampling Site")
plot(odata_core.nmds7, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS\nMicrochemistry from Otolith Core and Edge")
## CORE: set colors for points based on sampling site
points(odata_core.nmds7$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## EDGE: set colors for points based on sampling site
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 2, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 2, col = "gold2", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 2, col = "#bebada", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 2, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 2, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 2, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 2, col = "darkorange", cex = 1.2)
## add legend
legend(x="topleft", pch = c(19,19,19,19,19,19,19,19,2), bty="n", cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69","black","black"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "Pohang '15", "JinhaeBay '07e", "JinhaeBay '07l", "Core", "Edge"), title = "Sampling Site")
legend(x="bottomleft", pch = c(19,19,19,19,19,19,19,19,2), bty="n", cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69","black","black"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "Pohang '15", "JinhaeBay '07e", "JinhaeBay '07l", "Core", "Edge"), title = "Sampling Site")
plot(odata_core.nmds7, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS\nMicrochemistry from Otolith Core and Edge")
## CORE: set colors for points based on sampling site
points(odata_core.nmds7$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 19, col = "#b3de69", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 19, col = "gold2", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 19, col = "#bebada", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 19, col = "#fb8072", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 19, col = "#8dd3c7", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 19, col = "#80b1d3", cex = 1.2)
points(odata_core.nmds7$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 19, col = "darkorange", cex = 1.2)
## EDGE: set colors for points based on sampling site
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Pohang_2015",],
pch = 2, col = "#b3de69", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2015",],
pch = 2, col = "gold2", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Namhae_2015",],
pch = 2, col = "#bebada", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "YSBlock_2016",],
pch = 2, col = "#fb8072", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2007",],
pch = 2, col = "#8dd3c7", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "JinhaeBay_2008",],
pch = 2, col = "#80b1d3", cex = 1.2)
points(odata_edge.nmds7$points[odata_combo$SiteYear == "Geoje_2014",],
pch = 2, col = "darkorange", cex = 1.2)
## add legend
legend(x="bottomleft", pch = c(19,19,19,19,19,19,19,19,2), bty="n", cex = 1, pt.cex = 1.2,
col = c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69","black","black"),
legend = c("YSBlock '16", "Namhae '15", "Geoje '14", "Geoje '15", "Pohang '15", "JinhaeBay '07e", "JinhaeBay '07l", "Core", "Edge"), title = "Sampling Site")
plot(odata_core.nmds7, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS\nMicrochemistry from Otolith Core and Edge")
ordiellipse(odata_core_nojb.nmds5, combo_nojb$SiteYear, col=c("darkorange", "gold2", "#bebada", "#b3de69", "#fb8072"), kind = "sd", lty = 2, lwd = 1.5)
ordiellipse(odata_core.nmds7, combo_nojb$SiteYear, col=c("darkorange", "gold2", "#bebada", "#b3de69", "#fb8072"), kind = "sd", lty = 2, lwd = 1.5)
ordiellipse(odata_core.nmds7, combo_nojb$SiteYear, col=c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"), kind = "sd", lty = 2, lwd = 1.5)
ordiellipse(odata_core.nmds7, odata_combo$SiteYear, col=c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"), kind = "sd", lty = 2, lwd = 1.5)
plot(odata_core.nmds7, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS\nMicrochemistry from Otolith Core and Edge")
ordiellipse(odata_core.nmds7, odata_combo$SiteYear, col=c("#fb8072", "#bebada", "darkorange", "gold2", "#8dd3c7", "#80b1d3", "#b3de69"), kind = "sd", lty = 2, lwd = 1.5)
ordiellipse(odata_core.nmds7, odata_combo$SiteYear, col=c("darkorange", "gold2", "#8dd3c7", "#80b1d3", "#bebada", "#b3de69", "#fb8072"), kind = "sd", lty = 2, lwd = 1.5)
plot(odata_core.nmds7, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS\nMicrochemistry from Otolith Core and Edge", col="white")
ordiellipse(odata_core.nmds7, odata_combo$SiteYear, col=c("darkorange", "gold2", "#8dd3c7", "#80b1d3", "#bebada", "#b3de69", "#fb8072"), kind = "sd", lty = 2, lwd = 1.5)
ordiellipse(odata_edge.nmds7, odata_combo$SiteYear, col=c("darkorange", "gold2", "#8dd3c7", "#80b1d3", "#bebada", "#b3de69", "#fb8072"), kind = "sd", lty = 2, lwd = 1.5)
ordiellipse(odata_core.nmds7, odata_combo$SiteYear, col=c("darkorange", "gold2", "#8dd3c7", "#80b1d3", "#bebada", "#b3de69", "#fb8072"), kind = "sd", lwd = 1.5)
ordiellipse(odata_edge.nmds7, odata_combo$SiteYear, col=c("darkorange", "gold2", "#8dd3c7", "#80b1d3", "#bebada", "#b3de69", "#fb8072"), kind = "sd", lty = 2, lwd = 1.5)
plot(odata_core.nmds7, xaxt = "n", yaxt = "n", xlab = "", ylab = "", main = "NMDS\nMicrochemistry from Otolith Core and Edge", col="white")
ordiellipse(odata_core.nmds7, odata_combo$SiteYear, col=c("darkorange", "gold2", "#8dd3c7", "#80b1d3", "#bebada", "#b3de69", "#fb8072"), kind = "sd", lwd = 1.5)
ordiellipse(odata_edge.nmds7, odata_combo$SiteYear, col=c("darkorange", "gold2", "#8dd3c7", "#80b1d3", "#bebada", "#b3de69", "#fb8072"), kind = "sd", lty = 2, lwd = 1.5)
