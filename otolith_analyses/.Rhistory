names(odata_dendlist) <- c("edge", "core")
odata_dendlist %>% dendlist(which = c(1,2)) %>% ladderize %>%
set("branches_k_color", k=3) %>%
# untangle(method = "step1side", k_seq = 3:20) %>%
# set("clear_branches") %>% #otherwise the single lines are not black, since they retain the previous color from the branches_k_color.
tanglegram(faster = TRUE) # (common_subtrees_color_branches = TRUE)
g3 <- cutree(edge.hclust, k=3)
color_vec <- c(rep("pink",length(g3 == 1)), rep("green",length(g3 == 2)), rep("blue",length(g3 == 3)))
odata_dendlist %>% dendlist(which = c(1,2)) %>% ladderize %>%
set("branches_k_color", k=3) %>%
# untangle(method = "step1side", k_seq = 3:20) %>%
# set("clear_branches") %>% #otherwise the single lines are not black, since they retain the previous color from the branches_k_color.
tanglegram(faster = TRUE, color_lines=c("pink", "green", "blue")) # (common_subtrees_color_branches = TRUE)
gplots::heatmap.2(as.matrix(odata_edge.mrel),
main = "Heatmap for otolith edge",
srtCol = 20,
dendrogram = "row",
Rowv = dend_edge,
Colv = "NA", # this to make sure the columns are not ordered
trace="none",
margins =c(5,0.1),
key.xlab = "Cm",
denscol = "grey",
density.info = "density",
RowSideColors = rev(labels_colors(dend_edge)), # to add nice colored strips
col = some_col_func
)
library(gplots)
some_col_func <- function(n) rev(colorspace::heat_hcl(n, c = c(80, 30), l = c(30, 90), power = c(1/5, 1.5)))
gplots::heatmap.2(as.matrix(odata_edge.mrel),
main = "Heatmap for otolith edge",
srtCol = 20,
dendrogram = "row",
Rowv = dend_edge,
Colv = "NA", # this to make sure the columns are not ordered
trace="none",
margins =c(5,0.1),
key.xlab = "Cm",
denscol = "grey",
density.info = "density",
RowSideColors = rev(labels_colors(dend_edge)), # to add nice colored strips
col = some_col_func
)
dend_edge
dend_edge <- as.dendrogram(edge.hclust)
dend_edge <- color_branches(dend_edge, k=2)
dend_edge
plot(dend_edge)
colors <- rainbow_hcl(7)[sort_levels_values(as.numeric(as.factor(odata_combo$SiteYear))[order.dendrogram(dend_edge)])]
labels_colors(dend_edge) <- colors
labels(dend_edge) <- paste(as.character(as.factor(odata_combo$SiteYear))[order.dendrogram(dend_edge)],
"(",labels(dend_edge),")",
sep = "")
dend_edge <- set(dend_edge, "labels_cex", 0.5)
dend_edge <- hang.dendrogram(dend_edge,hang_height=0.1)
par(mar = c(3,3,3,7))
siteyears = unique(odata_combo$SiteYear)
plot(dend_edge,
main = "Clustered Edge Microchemistry by Site
(k=2)",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = siteyears, fill = unique(colors))
dend_edge <- as.dendrogram(edge.hclust)
dend_edge <- color_branches(dend_edge, k=2)
dend_edge
plot(dend_edge)
colors <- rainbow_hcl(5)[sort_levels_values(as.numeric(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_edge)])]
labels_colors(dend_edge) <- colors
labels(dend_edge) <- paste(as.character(as.factor(odata_combo$SiteYear))[order.dendrogram(dend_edge)],
"(",labels(dend_edge),")",
sep = "")
dend_edge <- set(dend_edge, "labels_cex", 0.5)
dend_edge <- hang.dendrogram(dend_edge,hang_height=0.1)
par(mar = c(3,3,3,7))
siteyears = unique(odata_combo$SiteYear)
plot(dend_edge,
main = "Clustered Edge Microchemistry by Site
(k=2)",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = siteyears, fill = rainbow_hcl(5))
dend_edge <- as.dendrogram(edge.hclust)
dend_edge <- color_branches(dend_edge, k=2)
dend_edge
plot(dend_edge)
colors <- rainbow_hcl(5)[sort_levels_values(as.numeric(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_edge)])]
labels_colors(dend_edge) <- colors
labels(dend_edge) <- paste(as.character(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_edge)],
"(",labels(dend_edge),")",
sep = "")
dend_edge <- set(dend_edge, "labels_cex", 0.5)
dend_edge <- hang.dendrogram(dend_edge,hang_height=0.1)
par(mar = c(3,3,3,7))
plot(dend_edge,
main = "Clustered Edge Microchemistry by Site
(k=2)",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = as.factor(odata_combo$Sampling.Site), fill = rainbow_hcl(5))
dend_edge <- as.dendrogram(edge.hclust)
dend_edge <- color_branches(dend_edge, k=2)
dend_edge
plot(dend_edge)
colors <- rainbow_hcl(5)[sort_levels_values(as.numeric(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_edge)])]
labels_colors(dend_edge) <- colors
labels(dend_edge) <- paste(as.character(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_edge)],
"(",labels(dend_edge),")",
sep = "")
dend_edge <- set(dend_edge, "labels_cex", 0.5)
dend_edge <- hang.dendrogram(dend_edge,hang_height=0.1)
par(mar = c(3,3,3,7))
plot(dend_edge,
main = "Clustered Edge Microchemistry by Site
(k=2)",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = odata_combo$Sampling.Site, fill = rainbow_hcl(5))
plot(dend_edge,
main = "Clustered Edge Microchemistry by Site
(k=2)",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = unique(odata_combo$Sampling.Site), fill = rainbow_hcl(5))
plot(dend_edge,
main = "Clustered Edge Microchemistry by Site
(k=2)",
horiz =  TRUE,  nodePar = list(cex = .007), hang=-1)
plot(dend_edge,
main = "Clustered Edge Microchemistry by Site
(k=2)",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = unique(odata_combo$Sampling.Site), fill = rainbow_hcl(5))
dend_core <- as.dendrogram(core.hclust)
dend_core <- color_branches(dend_core, k=2)
dend_core
colors <- rainbow_hcl(5)[sort_levels_values(as.numeric(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_core)])]
labels_colors(dend_core) <- colors
labels(dend_core) <- paste(as.character(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_core)], "(",labels(dend_ecore),")", sep = "")
dend_core <- set(dend_core, "labels_cex", 0.5)
dend_core <- hang.dendrogram(dend_core,hang_height=0.1)
par(mar = c(3,3,3,7))
plot(dend_core,
main = "Clustered Core Microchemistry by Site
(k=2)",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = unique(odata_combo$Sampling.Site), fill = rainbow_hcl(5))
dend_core <- as.dendrogram(core.hclust)
dend_core <- color_branches(dend_core, k=2)
dend_core
colors <- rainbow_hcl(5)[sort_levels_values(as.numeric(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_core)])]
labels_colors(dend_core) <- colors
labels(dend_core) <- paste(as.character(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_core)], "(",labels(dend_core),")", sep = "")
dend_core <- set(dend_core, "labels_cex", 0.5)
dend_core <- hang.dendrogram(dend_core,hang_height=0.1)
par(mar = c(3,3,3,7))
plot(dend_core,
main = "Clustered Core Microchemistry by Site
(k=2)",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = unique(odata_combo$Sampling.Site), fill = rainbow_hcl(5))
rainbow_hcl(5)
legend("topleft", legend = unique(odata_combo$Sampling.Site), fill = rev(rainbow_hcl(5)))
legend("topleft", legend = unique(odata_combo$Sampling.Site), fill = rainbow_hcl(5))
leg_colors <- c("#C29DDE", "#BDAB66", "#65BC8C", "#55B8D0", "#E495A5")
legend("topleft", legend = unique(odata_combo$Sampling.Site), fill = leg_colors)
dend_core <- color_branches(dend_core, k=3)
colors <- rainbow_hcl(5)[sort_levels_values(as.numeric(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_core)])]
labels_colors(dend_core) <- colors
labels(dend_core) <- paste(as.character(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_core)], "(",labels(dend_core),")", sep = "")
dend_core <- set(dend_core, "labels_cex", 0.5)
dend_core <- hang.dendrogram(dend_core,hang_height=0.1)
par(mar = c(3,3,3,7))
plot(dend_core,
main = "Clustered Core Microchemistry by Site
(k=2)",
horiz =  TRUE,  nodePar = list(cex = .007))
leg_colors <- c("#C29DDE", "#BDAB66", "#65BC8C", "#55B8D0", "#E495A5")
legend("topleft", legend = unique(odata_combo$Sampling.Site), fill = leg_colors)
str(core.hclust)
dend_edge <- as.dendrogram(edge.hclust)
dend_edge <- color_branches(dend_edge, k=2)
dend_edge
plot(dend_edge)
colors <- rainbow_hcl(5)[sort_levels_values(as.numeric(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_edge)])]
labels_colors(dend_edge) <- colors
labels(dend_edge) <- paste(as.character(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_edge)],
"(",labels(dend_edge),")",
sep = "")
dend_edge <- set(dend_edge, "labels_cex", 0.5)
dend_edge <- hang.dendrogram(dend_edge,hang_height=0.1)
par(mar = c(3,3,3,7))
plot(dend_edge,
main = "Clustered Edge Microchemistry by Site
(k=2)",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = unique(odata_combo$Sampling.Site), fill = rainbow_hcl(5))
library(dendextend)
install.packages("colorspace")
install.packages("colorspace")
library(dendextend)
library(colorspace)
library(ggplot2)
install.packages("colorspace")
library(colorspace)
install.packages("ggplot2")
library(ggplot2)
install.packages("dplyr")
library(dplyr)
dend_edge <- as.dendrogram(edge.hclust)
dend_edge <- color_branches(dend_edge, k=2)
dend_edge
plot(dend_edge)
colors <- rainbow_hcl(5)[sort_levels_values(as.numeric(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_edge)])]
labels_colors(dend_edge) <- colors
labels(dend_edge) <- paste(as.character(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_edge)],
"(",labels(dend_edge),")",
sep = "")
dend_edge <- set(dend_edge, "labels_cex", 0.5)
dend_edge <- hang.dendrogram(dend_edge,hang_height=0.1)
par(mar = c(3,3,3,7))
plot(dend_edge,
main = "Clustered Edge Microchemistry by Site
(k=2)",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = unique(odata_combo$Sampling.Site), fill = rainbow_hcl(5))
library(dendextend)
dend_edge <- as.dendrogram(edge.hclust)
dend_edge <- color_branches(dend_edge, k=2)
dend_edge
plot(dend_edge)
colors <- rainbow_hcl(5)[sort_levels_values(as.numeric(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_edge)])]
labels(dend_edge) <- paste(as.character(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_edge)],
"(",labels(dend_edge),")",
sep = "")
dend_edge <- set(dend_edge, "labels_cex", 0.5)
dend_edge <- hang.dendrogram(dend_edge,hang_height=0.1)
par(mar = c(3,3,3,7))
plot(dend_edge,
main = "Clustered Edge Microchemistry by Site
(k=2)",
horiz =  TRUE,  nodePar = list(cex = .007))
legend("topleft", legend = unique(odata_combo$Sampling.Site), fill = rainbow_hcl(5))
dend_core <- as.dendrogram(core.hclust)
dend_core <- color_branches(dend_core, k=3)
dend_core
colors <- rainbow_hcl(5)[sort_levels_values(as.numeric(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_core)])]
labels_colors(dend_core) <- colors
labels(dend_core) <- paste(as.character(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_core)], "(",labels(dend_core),")", sep = "")
dend_core <- set(dend_core, "labels_cex", 0.5)
dend_core <- hang.dendrogram(dend_core,hang_height=0.1)
par(mar = c(3,3,3,7))
plot(dend_core,
main = "Clustered Core Microchemistry by Site
(k=2)",
horiz =  TRUE,  nodePar = list(cex = .007))
leg_colors <- c("#C29DDE", "#BDAB66", "#65BC8C", "#55B8D0", "#E495A5")
legend("topleft", legend = unique(odata_combo$Sampling.Site), fill = leg_colors)
dend_core <- as.dendrogram(core.hclust)
dend_core <- color_branches(dend_core, k=2) # K will color branches by # groups
dend_core
colors <- rainbow_hcl(5)[sort_levels_values(as.numeric(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_core)])]
labels_colors(dend_core) <- colors
labels(dend_core) <- paste(as.character(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_core)], "(",labels(dend_core),")", sep = "")
dend_core <- set(dend_core, "labels_cex", 0.5)
dend_core <- hang.dendrogram(dend_core,hang_height=0.1)
par(mar = c(3,3,3,7))
plot(dend_core,
main = "Clustered Core Microchemistry by Site
(k=2)",
horiz =  TRUE,  nodePar = list(cex = .007))
leg_colors <- c("#C29DDE", "#BDAB66", "#65BC8C", "#55B8D0", "#E495A5")
legend("topleft", legend = unique(odata_combo$Sampling.Site), fill = leg_colors)
install.packages("circlize")
library(circlize)
circlize_dendrogram(dend_edge)
dend_edge <- as.dendrogram(edge.hclust)
dend_edge <- color_branches(dend_edge, k=2) # K will color branches by # groups
dend_edge
colors <- rainbow_hcl(5)[sort_levels_values(as.numeric(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_edge)])]
labels_colors(dend_edge) <- colors
labels(dend_edge) <- paste(as.character(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_edge)], "(",labels(dend_edge),")", sep = "")
dend_edge <- set(dend_edge, "labels_cex", 0.5)
dend_edge <- hang.dendrogram(dend_edge,hang_height=0.1)
par(mar = c(3,3,3,7))
plot(dend_edge,
main = "Clustered Edge Microchemistry by Site
(k=2)",
horiz =  TRUE,  nodePar = list(cex = .007))
leg_colors <- c("#C29DDE", "#BDAB66", "#65BC8C", "#55B8D0", "#E495A5")
legend("topleft", legend = unique(odata_combo$Sampling.Site), fill = leg_colors)
edge.hclust <- hclust(d = edge.mrel_dist, method = "ward.D2") # create object outside function
core.hclust <- hclust(d = core.mrel_dist, method = "ward.D2") # create object outside function
#
cutree(edge.hclust, k=2)
dend_core <- as.dendrogram(core.hclust)
dend_core <- color_branches(dend_core, k=2) # K will color branches by # groups
dend_core
colors <- rainbow_hcl(5)[sort_levels_values(as.numeric(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_core)])]
labels_colors(dend_core) <- colors
labels(dend_core) <- paste(as.character(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_core)], "(",labels(dend_core),")", sep = "")
dend_core <- set(dend_core, "labels_cex", 0.5)
dend_core <- hang.dendrogram(dend_core,hang_height=0.1)
par(mar = c(3,3,3,7))
plot(dend_core,
main = "Clustered Core Microchemistry by Site
(k=2)",
horiz =  TRUE,  nodePar = list(cex = .007))
leg_colors <- c("#C29DDE", "#BDAB66", "#65BC8C", "#55B8D0", "#E495A5")
legend("topleft", legend = unique(odata_combo$Sampling.Site), fill = leg_colors)
dend_core <- as.dendrogram(core.hclust)
dend_core <- color_branches(dend_core, k=2) # K will color branches by # groups
dend_core
colors <- rainbow_hcl(5)[sort_levels_values(as.numeric(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_core)])]
labels_colors(dend_core) <- colors
labels(dend_core) <- paste(as.character(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_core)], "(",labels(dend_core),")", sep = "")
dend_core <- set(dend_core, "labels_cex", 0.5)
dend_core <- hang.dendrogram(dend_core,hang_height=0.1)
par(mar = c(3,3,3,7))
plot(dend_core,
main = "Clustered Core Microchemistry by Site
(k=2)",
horiz =  TRUE,  nodePar = list(cex = .007))
leg_colors <- c("#C29DDE", "#BDAB66", "#65BC8C", "#55B8D0", "#E495A5")
legend("topleft", legend = unique(odata_combo$Sampling.Site), fill = leg_colors)
dend_edge <- as.dendrogram(edge.hclust)
dend_edge <- color_branches(dend_edge, k=2) # K will color branches by # groups
dend_edge
colors <- rainbow_hcl(5)[sort_levels_values(as.numeric(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_edge)])]
labels_colors(dend_edge) <- colors
labels(dend_edge) <- paste(as.character(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_edge)], "(",labels(dend_edge),")", sep = "")
dend_edge <- set(dend_edge, "labels_cex", 0.5)
dend_edge <- hang.dendrogram(dend_edge,hang_height=0.1)
par(mar = c(3,3,3,7))
plot(dend_edge,
main = "Clustered Edge Microchemistry by Site
(k=2)",
horiz =  TRUE,  nodePar = list(cex = .007))
leg_colors <- c("#C29DDE", "#BDAB66", "#65BC8C", "#55B8D0", "#E495A5")
legend("topleft", legend = unique(odata_combo$Sampling.Site), fill = leg_colors)
edge2 <- rect.hclust(edge.hclust, k=2)
edge2
edge2 <- rect.hclust(edge.hclust, k=2)
edge3 <- rect.hclust(edge.hclust, k=3)
core2 <- rect.hclust(core.hclust, k=2)
core3 <- rect.hclust(core.hclust, k=3)
##--pvclust package: https://cran.r-pr
edge3
core2
core3
dend_edge <- as.dendrogram(edge.hclust)
dend_edge <- color_branches(dend_edge, k=2) # K will color branches by # groups
dend_edge
colors <- rainbow_hcl(5)[sort_levels_values(as.numeric(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_edge)])]
labels_colors(dend_edge) <- colors
labels(dend_edge) <- paste(as.character(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_edge)], "(",labels(dend_edge),")", sep = "")
dend_edge <- set(dend_edge, "labels_cex", 0.5)
dend_edge <- hang.dendrogram(dend_edge,hang_height=0.1)
par(mar = c(3,3,3,7))
plot(dend_edge,
main = "Clustered Edge Microchemistry by Site
(k=2)",
horiz =  TRUE,  nodePar = list(cex = .007))
leg_colors <- c("#C29DDE", "#BDAB66", "#65BC8C", "#55B8D0", "#E495A5")
legend("topleft", legend = unique(odata_combo$Sampling.Site), fill = leg_colors)
g3 <- cutree(edge.hclust, k=3)
color_vec <- c(rep("pink",length(g3 == 1)), rep("green",length(g3 == 2)), rep("blue",length(g3 == 3)))
odata_dendlist %>% dendlist(which = c(1,2)) %>% ladderize %>%
tanglegram(faster = TRUE, color_lines=color_vec) # (common_subtrees_color_branches = TRUE)
g3
color_vec
length(which(color_vec=="pink"))
length(which(color_vec=="blue"))
which(color_vec=="blue")
color_vec=="blue"
color_vec <-c(rep("pink",30), rep("green",length(g3 == 2)), rep("blue",length(g3 == 3)))
odata_dendlist %>% dendlist(which = c(1,2)) %>% ladderize %>%
tanglegram(faster = TRUE, color_lines=color_vec) # (common_subtrees_color_branches = TRUE)
color_vec <-c(rep("pink",50), rep("blue",30))
odata_dendlist %>% dendlist(which = c(1,2)) %>% ladderize %>%
tanglegram(faster = TRUE, color_lines=color_vec) # (common_subtrees_color_branches = TRUE)
color_vec <-c(rep("pink",100), rep("blue",30))
odata_dendlist %>% dendlist(which = c(1,2)) %>% ladderize %>%
tanglegram(faster = TRUE, color_lines=color_vec) # (common_subtrees_color_branches = TRUE)
dendlist
edge.hclust
str(edge.hclust)
as.character(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_edge)]
sites_ordered <- as.character(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_edge)]
sites_ordered <- as.character(as.factor(odata_combo$Sampling.Site))[order.dendrogram(dend_edge)]
color_vec <- c()
for(i in sites_ordered){
if( i == "Pohang"){
color_vec <- c(color_vec, "#b3de69")
} else if ( i == "Geoje"){
color_vec <- c(color_vec, "gold2")
} else if ( i == "Namhae"){
color_vec <- c(color_vec, "gold2")
} else if ( i == "YSBlock"){
color_vec <- c(color_vec, "#fb8072")
} else if ( i == "JinhaeBay"){
color_vec <- c(color_vec, "#80b1d3")
}
}
source('D:/Pacific cod/DataAnalysis/PCod-Korea-repo/otolith_analyses/scripts/project_script7_cluster_compare.R', echo=TRUE)
color_vec
odata_dendlist %>% dendlist(which = c(1,2)) %>% ladderize %>%
tanglegram(faster = TRUE, color_lines=color_vec) # (common_subtrees_color_branches = TRUE)
color_vec_jb <- c()
for(i in sites_ordered){
if( i == "JinhaeBay"){
color_vec_jb <- c(color_vec, "#80b1d3")
} else {
color_vec_jb <- c(color_vec, "grey2")
}
}
color_vec_jb
odata_dendlist %>% dendlist(which = c(1,2)) %>% ladderize %>%
tanglegram(faster = TRUE, color_lines=color_vec_jb) # (common_subtrees_color_branches = TRUE)
color_vec_jb <- c()
for(i in sites_ordered){
if( i == "JinhaeBay"){
color_vec_jb <- c(color_vec_jb, "#80b1d3")
} else {
color_vec_jb <- c(color_vec_jb, "grey2")
}
}
color_vec_jb
odata_dendlist %>% dendlist(which = c(1,2)) %>% ladderize %>%
tanglegram(faster = TRUE, color_lines=color_vec_jb) # (common_subtrees_color_branches = TRUE)
for(i in sites_ordered){
if( i == "JinhaeBay"){
color_vec_jb <- c(color_vec_jb, "#80b1d3")
} else {
color_vec_jb <- c(color_vec_jb, "lightgrey")
}
}
color_vec_jb
color_vec_jb <- c()
for(i in sites_ordered){
if( i == "JinhaeBay"){
color_vec_jb <- c(color_vec_jb, "#80b1d3")
} else {
color_vec_jb <- c(color_vec_jb, "lightgrey")
}
}
color_vec_jb
odata_dendlist %>% dendlist(which = c(1,2)) %>% ladderize %>%
tanglegram(faster = TRUE, color_lines=color_vec_jb) # (common_subtrees_color_branches = TRUE)
color_vec_ys <- c()
for(i in sites_ordered){
if( i == "YSBlock"){
color_vec_ys <- c(color_vec_ys, "#fb8072")
} else {
color_vec_ys <- c(color_vec_ys, "lightgrey")
}
}
odata_dendlist %>% dendlist(which = c(1,2)) %>% ladderize %>%
tanglegram(faster = TRUE, color_lines=color_vec_ys) # (common_subtrees_color_branches = TRUE)
color_vec <- c()
for(i in sites_ordered){
if( i == "Pohang"){
color_vec <- c(color_vec, "#b3de69")
} else if ( i == "Geoje"){
color_vec <- c(color_vec, "gold2")
} else if ( i == "Namhae"){
color_vec <- c(color_vec, "#bebada")
} else if ( i == "YSBlock"){
color_vec <- c(color_vec, "#fb8072")
} else if ( i == "JinhaeBay"){
color_vec <- c(color_vec, "#8dd3c7")
}
}
color_vec
odata_dendlist %>% dendlist(which = c(1,2)) %>% ladderize %>%
tanglegram(faster = TRUE, color_lines=color_vec) # (common_subtrees_color_branches = TRUE)
color_vec_jb <- c()
for(i in sites_ordered){
if( i == "JinhaeBay"){
color_vec_jb <- c(color_vec_jb, "#8dd3c7")
} else {
color_vec_jb <- c(color_vec_jb, "lightgrey")
}
}
color_vec_jb
odata_dendlist %>% dendlist(which = c(1,2)) %>% ladderize %>%
tanglegram(faster = TRUE, color_lines=color_vec_jb) # (common_subtrees_color_branches = TRUE)
color_vec_ys <- c()
for(i in sites_ordered){
if( i == "YSBlock"){
color_vec_ys <- c(color_vec_ys, "#fb8072")
} else {
color_vec_ys <- c(color_vec_ys, "lightgrey")
}
}
odata_dendlist %>% dendlist(which = c(1,2)) %>% ladderize %>%
tanglegram(faster = TRUE, color_lines=color_vec_ys) # (common_subtrees_color_branches = TRUE)
color_vec_po <- c()
for(i in sites_ordered){
if( i == "Pohang"){
color_vec_po <- c(color_vec_po, "#b3de69")
} else {
color_vec_po <- c(color_vec_po, "lightgrey")
}
}
odata_dendlist %>% dendlist(which = c(1,2)) %>% ladderize %>%
tanglegram(faster = TRUE, color_lines=color_vec_po) # (common_subtrees_color_branches = TRUE)
color_vec_ge <- c()
for(i in sites_ordered){
if( i == "Geoje"){
color_vec_ge <- c(color_vec_ge, "gold2")
} else {
color_vec_ge <- c(color_vec_ge, "lightgrey")
}
}
odata_dendlist %>% dendlist(which = c(1,2)) %>% ladderize %>%
tanglegram(faster = TRUE, color_lines=color_vec_ge) # (common_subtrees_color_branches = TRUE)
